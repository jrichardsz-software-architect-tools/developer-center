
---
|endpoint-id|
|:-------|
|endpoint-105|

---

# Validate v2 Token

Validate the relationship between token, subject(person or client), option (endpoint or menu web), http method and application

**Base Url** : `{{horusApiBaseUrl}}`

**Endpoint** : `/v2/oauth2/token/validate`

**Method** : `POST`

**Auth required** : No

**Permissions required** : No

## Request

**type: body**

**validate web**

```json
{
   "token":"eyJhbGciOiJIUz***pC5NQlLo",
   "permission":"acme-api:tnt-bomb:create",
   "appIdentifier":"api1"
}
```

**validate api**

```json
{
  "code": 200000,
  "message": "success",
  "content": {
    "isAllowed": true,
    "subject": "03f3a095-4005-4c19-9cda-728b5a75fcf7",
    "options": [{
        "id": 4,
        "identifier": "acme-api:tnt-bomb:create",
        "name": "acme-api:tnt-bomb:create",
        "value": "acme-api:tnt-bomb:create",
        "httpMethod": "NOT_HTTP_METHOD",
        "description": "acme-api:tnt-bomb:create",
        "order": 0,
        "type": "REST_PERMISSION",
        "custom": "",
        "legacy": false,
        "requested": 1
      },
      {
        "id": 3,
        "identifier": "endpoint1",
        "name": "endpoint1",
        "value": "/endpoint1",
        "httpMethod": "POST",
        "description": "endpoint1",
        "order": 0,
        "type": "REST_ENDPOINT",
        "custom": "",
        "legacy": false,
        "requested": 0
      },
      {
          "id": 4,
          "identifier": "acme-api:tnt-bomb:should-update-name-field",
          "name": "acme-api:tnt-bomb:should-update-name-field",
          "value": "acme-api:tnt-bomb:should-update-name-field",
          "httpMethod": "NOT_HTTP_METHOD",
          "description": "acme-api:tnt-bomb:should-update-name-field",
          "order": 0,
          "type": "INTERNAL_RULE",
          "custom": "",
          "legacy": false,
          "requested": 1
        }      
    ]
  }
}
```

**Request Fields Description**

| key | data-type | required | description |
|------------|--------------|-------------|-------------|
| token  |  string | yes | valid access_token previously generated by horus |
| optionValue  |  string | yes | rest endpoint or menu web registered in horus |
| httpMethod  |  string | yes | http method related to the rest endpoint. Use **NOT_HTTP_METHOD** for web apps|
| appName  |  string | yes | aplication identifier previously registered in horus|

**Request Headers Description**

| header key | header value | description |
|------------|--------------|-------------|
| x-usil-request-id  |  4512451 | random alphanumeric value which identify this event |


## Response

```json
{
    "code": 200000,
    "message": "success",
    "content": {
        "isAllowed": true,
        "subject": "sanvi@828fligth.com"
    }
}
```

**Response Fields Description**


| field | data-type | description |
|------------|--------------|-------------|
| code  | int | numeric value which indicates the success or failure of invocation. 200XYZ for success and any other value for failures  |
| message  | string | message related to code. On errors contains a description  |
| content.isAllowed  | boolean | flag that indicated if user related to the entered token has access to the aplication, endpoint and method  |
| content.subject  | string | person email or clientId related to the entered token  |

**Response Headers Description**

| header key | header value | description |
|------------|--------------|-------------|
| x-usil-request-id  |  ***** | value received in request headers or a  random alphanumeric value if client don't send it|

**Response codes**

- If response is success, http **status** will be **200** and **code** in body will be **200XYZ**
- If the invocation ends with error, http status will have the standard status: 401, 403, 500, 502, etc and the code in body will contain an extra numeric values to classify the error:
  - 400xyz
  - 401xyz
  - 403xyz
  - 500xyz
  - etcxyz


| code | description |
|------------|-------------|
| 403100  | token expired |
| 403101  | token malformed  |
